---
# build a Centos server running a secure Docker CE install

- name: Setup Fail2ban
  hosts: staging_dockerhost

  tasks:
    - debug:
        msg: "target host: {{ inventory_hostname }}"

  roles:
    - role: fail2ban
    - role: jail-ssh

- name: Setup Docker CE
  hosts: staging_dockerhost

  tasks:
    - debug:
        msg: "target host: {{ inventory_hostname }}"

  roles:
    - role: docker-install
    - role: role-secure-docker-daemon
      dds_host: 0.0.0.0
      dds_server_cert_path: /etc/docker
      dds_restart_docker: no
    - role: docker-postinstall
    - role: postgres-install